CREATE TABLE "public"."resource_versions" ("id" uuid NOT NULL DEFAULT gen_random_uuid(), "resource_id" uuid NOT NULL, "message_id" uuid NOT NULL, "version_number" integer NOT NULL, "file_name" text NOT NULL, "file_type" text NOT NULL, "mime_type" text, "size_bytes" bigint, "storage_path" text NOT NULL, "model" text, "metadata" jsonb NOT NULL, "created_at" timestamptz NOT NULL DEFAULT now(), PRIMARY KEY ("id") , FOREIGN KEY ("resource_id") REFERENCES "public"."resources"("id") ON UPDATE restrict ON DELETE cascade, FOREIGN KEY ("message_id") REFERENCES "public"."chat_messages"("id") ON UPDATE restrict ON DELETE cascade, UNIQUE ("id"));
CREATE EXTENSION IF NOT EXISTS pgcrypto;
