CREATE TABLE "public"."resource_events" ("id" uuid NOT NULL DEFAULT gen_random_uuid(), "resource_id" uuid NOT NULL, "resource_version_id" uuid NOT NULL, "event_type" text NOT NULL, "actor_type" text NOT NULL, "user_id" text NOT NULL, "message_id" uuid NOT NULL, "metadata" jsonb NOT NULL, "created_at" timestamptz NOT NULL DEFAULT now(), PRIMARY KEY ("id") , FOREIGN KEY ("resource_id") REFERENCES "public"."resources"("id") ON UPDATE restrict ON DELETE cascade, FOREIGN KEY ("resource_version_id") REFERENCES "public"."resource_versions"("id") ON UPDATE restrict ON DELETE cascade, FOREIGN KEY ("message_id") REFERENCES "public"."chat_messages"("id") ON UPDATE restrict ON DELETE cascade, UNIQUE ("id"));
CREATE EXTENSION IF NOT EXISTS pgcrypto;
